create schema lab1;
set search_path to lab1;

create table if not exists billing(
  payer_email VARCHAR(255) NULL,
  recipient_email VARCHAR(255) NULL,
  sum DECIMAL(18,2) NULL,
  currency VARCHAR(3) NULL,
  billing_date DATE NULL,
  comment TEXT NULL
);


INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'petya@mail.com', 681.00, 'AUD', '2015-12-13', 'Procrastinator? No, I just wait until the last second to do my work because I will be older, therefore wiser.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'ivan@mail.com', 714.00, 'EUR', '2015-12-22', 'You remind me of my Chinese friend...Ug Lee.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'bobby@mail.com', 338.00, 'SGD', '2015-01-14', 'I just dropped my laptop off the boat.....It''s a Dell, rolling in the deep.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'lenny@mail.com', 157.00, 'INR', '2015-06-17', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'alex@mail.com', 623.00, 'CHF', '2015-01-04', 'I just dropped my laptop off the boat.....It''s a Dell, rolling in the deep.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'john@mail.com', 722.00, 'EUR', '2015-09-02', 'I feel like getting something done today, so I''m just going to sit here until the feeling passes.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'leo@mail.com', 198.00, 'JPY', '2015-08-19', 'Whatever you do in life give 100%.....unless you''re giving blood.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'enzo@mail.com', 240.00, 'MYR', '2015-06-20', 'I was complimented on my driving. Someone left a note on my windshield that said, ''Parking Fine.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'franz@mail.com', 647.00, 'JPY', '2015-03-08', 'I was complimented on my driving. Someone left a note on my windshield that said, ''Parking Fine.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'vasya@mail.com', 960.00, 'CHF', '2015-07-09', 'I really like ceilings......I guess you could call me a ceiling fan.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'ivan@mail.com', 141.00, 'MYR', '2015-11-26', 'I was complimented on my driving. Someone left a note on my windshield that said, ''Parking Fine.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'bobby@mail.com', 776.00, 'JPY', '2015-05-29', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'lenny@mail.com', 546.00, 'INR', '2015-09-18', 'Grammar is somewhat important. Commas do save lives for instance: ''Let''s eat grandpa.'' ''Lets eat, grandpa.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'alex@mail.com', 251.00, 'CAD', '2015-01-21', 'I feel like getting something done today, so I''m just going to sit here until the feeling passes.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'john@mail.com', 646.00, 'CHF', '2015-01-13', 'Whatever you do in life give 100%.....unless you''re giving blood.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'leo@mail.com', 997.00, 'MYR', '2015-08-10', 'Better late then never, but never late is better.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'enzo@mail.com', 261.00, 'AUD', '2015-12-27', 'I speak my mind. I never mind what I speak.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'franz@mail.com', 687.00, 'INR', '2015-01-19', 'Procrastinator? No, I just wait until the last second to do my work because I will be older, therefore wiser.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'vasya@mail.com', 211.00, 'AUD', '2015-05-23', 'Grammar is somewhat important. Commas do save lives for instance: ''Let''s eat grandpa.'' ''Lets eat, grandpa.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'petya@mail.com', 352.00, 'SGD', '2015-06-04', 'Better late then never, but never late is better.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'bobby@mail.com', 930.00, 'GBP', '2015-01-09', 'Whatever you do in life give 100%.....unless you''re giving blood.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'lenny@mail.com', 639.00, 'EUR', '2015-09-14', 'I haven''t seen any statuses about Ninjas lately....well played Ninjas.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'alex@mail.com', 142.00, 'SGD', '2015-07-26', 'On a scale of Voldemort to Pinocchio, how Nosy are you?');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'john@mail.com', 276.00, 'SGD', '2015-10-18', 'I changed all my passwords to ''incorrect''. So my computer just tells me when I forgot.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'leo@mail.com', 258.00, 'CAD', '2015-05-21', 'Better late then never, but never late is better.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'enzo@mail.com', 109.00, 'USD', '2015-09-03', 'The dictionary is the only place where success comes before work.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'franz@mail.com', 799.00, 'SGD', '2015-04-20', 'I just dropped my laptop off the boat.....It''s a Dell, rolling in the deep.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'vasya@mail.com', 759.00, 'EUR', '2015-04-14', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'petya@mail.com', 412.00, 'AUD', '2015-01-25', 'I haven''t seen any statuses about Ninjas lately....well played Ninjas.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'ivan@mail.com', 394.00, 'GBP', '2015-09-07', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'lenny@mail.com', 300.00, 'EUR', '2015-05-09', 'I love how, in horror movies, the person yells out,Hello? As if the bad is going to yell back, Yeah, I''m in the kitchen! Do you want a sandwich? Or,Hey, yeah I''m back here with a chainsaw. Come on down.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'alex@mail.com', 800.00, 'USD', '2015-01-01', 'I do 5 sit-ups every morning. May not sound like much, but there is only so many times you can hit the snooze button...');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'john@mail.com', 429.00, 'CAD', '2015-09-03', 'I dream of a better tomorrow, where chickens can cross the road and not be questioned about their motives.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'leo@mail.com', 580.00, 'GBP', '2015-09-16', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'enzo@mail.com', 335.00, 'CAD', '2015-03-24', 'One time at the beach this guy was swimming in the ocean yelling Help! Shark! Help!. I just laughed, I knew that shark wasn''t going to help them.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'franz@mail.com', 610.00, 'JPY', '2015-06-14', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'vasya@mail.com', 356.00, 'MYR', '2015-11-12', 'I feel like getting something done today, so I''m just going to sit here until the feeling passes.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'petya@mail.com', 993.00, 'JPY', '2015-03-30', 'I changed all my passwords to ''incorrect''. So my computer just tells me when I forgot.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'ivan@mail.com', 824.00, 'GBP', '2015-08-28', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'bobby@mail.com', 422.00, 'EUR', '2015-05-04', 'No I didn''t trip, the floor looked like it needed a hug.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'alex@mail.com', 845.00, 'CAD', '2015-04-11', 'The dictionary is the only place where success comes before work.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'john@mail.com', 925.00, 'USD', '2015-07-09', 'Grammar is somewhat important. Commas do save lives for instance: ''Let''s eat grandpa.'' ''Lets eat, grandpa.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'leo@mail.com', 185.00, 'EUR', '2015-08-21', 'I just dropped my laptop off the boat.....It''s a Dell, rolling in the deep.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'enzo@mail.com', 245.00, 'GBP', '2015-02-20', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'franz@mail.com', 533.00, 'GBP', '2015-01-16', 'You remind me of my Chinese friend...Ug Lee.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'vasya@mail.com', 502.00, 'AUD', '2015-10-28', 'I was complimented on my driving. Someone left a note on my windshield that said, ''Parking Fine.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'petya@mail.com', 110.00, 'EUR', '2015-05-10', 'I changed all my passwords to ''incorrect''. So my computer just tells me when I forgot.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'ivan@mail.com', 223.00, 'GBP', '2015-08-01', 'Grammar is somewhat important. Commas do save lives for instance: ''Let''s eat grandpa.'' ''Lets eat, grandpa.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'bobby@mail.com', 177.00, 'USD', '2015-03-16', 'I speak my mind. I never mind what I speak.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'lenny@mail.com', 839.00, 'USD', '2015-11-06', 'I dream of a better tomorrow, where chickens can cross the road and not be questioned about their motives.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'john@mail.com', 942.00, 'CHF', '2015-12-07', 'Better late then never, but never late is better.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'leo@mail.com', 102.00, 'GBP', '2015-02-15', 'I do 5 sit-ups every morning. May not sound like much, but there is only so many times you can hit the snooze button...');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'enzo@mail.com', 711.00, 'AUD', '2015-05-29', 'I speak my mind. I never mind what I speak.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'franz@mail.com', 624.00, 'USD', '2015-01-08', 'I love how, in horror movies, the person yells out,Hello? As if the bad is going to yell back, Yeah, I''m in the kitchen! Do you want a sandwich? Or,Hey, yeah I''m back here with a chainsaw. Come on down.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'vasya@mail.com', 698.00, 'USD', '2015-02-26', 'I wonder if tap dancers walk into a room, look at the floor and think,''I''d so tap that.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'petya@mail.com', 843.00, 'MYR', '2015-02-14', 'I wonder if tap dancers walk into a room, look at the floor and think,''I''d so tap that.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'ivan@mail.com', 808.00, 'EUR', '2015-09-21', 'I wonder if tap dancers walk into a room, look at the floor and think,''I''d so tap that.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'bobby@mail.com', 527.00, 'AUD', '2015-08-09', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'lenny@mail.com', 585.00, 'CHF', '2015-09-06', 'You remind me of my Chinese friend...Ug Lee.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'alex@mail.com', 808.00, 'CAD', '2015-06-07', 'One time at the beach this guy was swimming in the ocean yelling Help! Shark! Help!. I just laughed, I knew that shark wasn''t going to help them.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'leo@mail.com', 349.00, 'USD', '2015-10-07', 'I was complimented on my driving. Someone left a note on my windshield that said, ''Parking Fine.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'enzo@mail.com', 265.00, 'INR', '2015-06-29', 'I dream of a better tomorrow, where chickens can cross the road and not be questioned about their motives.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'franz@mail.com', 180.00, 'SGD', '2015-03-15', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'vasya@mail.com', 129.00, 'USD', '2015-10-06', 'You remind me of my Chinese friend...Ug Lee.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'petya@mail.com', 703.00, 'SGD', '2015-03-31', 'I haven''t seen any statuses about Ninjas lately....well played Ninjas.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'ivan@mail.com', 533.00, 'EUR', '2015-02-04', 'Procrastinator? No, I just wait until the last second to do my work because I will be older, therefore wiser.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'bobby@mail.com', 129.00, 'SGD', '2015-10-31', 'On a scale of Voldemort to Pinocchio, how Nosy are you?');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'lenny@mail.com', 858.00, 'MYR', '2015-04-14', 'I changed all my passwords to ''incorrect''. So my computer just tells me when I forgot.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'alex@mail.com', 461.00, 'JPY', '2015-08-09', 'Grammar is somewhat important. Commas do save lives for instance: ''Let''s eat grandpa.'' ''Lets eat, grandpa.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'john@mail.com', 467.00, 'CAD', '2015-01-07', 'I wonder if tap dancers walk into a room, look at the floor and think,''I''d so tap that.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'enzo@mail.com', 684.00, 'USD', '2015-05-07', 'No I didn''t trip, the floor looked like it needed a hug.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'franz@mail.com', 329.00, 'CHF', '2015-01-28', 'Grammar is somewhat important. Commas do save lives for instance: ''Let''s eat grandpa.'' ''Lets eat, grandpa.''');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'vasya@mail.com', 823.00, 'JPY', '2015-12-18', 'I just dropped my laptop off the boat.....It''s a Dell, rolling in the deep.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'petya@mail.com', 377.00, 'CHF', '2015-07-20', 'Whatever you do in life give 100%.....unless you''re giving blood.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'ivan@mail.com', 604.00, 'GBP', '2015-04-17', 'I haven''t seen any statuses about Ninjas lately....well played Ninjas.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'bobby@mail.com', 979.00, 'GBP', '2015-04-15', 'One time at the beach this guy was swimming in the ocean yelling Help! Shark! Help!. I just laughed, I knew that shark wasn''t going to help them.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'lenny@mail.com', 683.00, 'JPY', '2015-05-15', 'One time at the beach this guy was swimming in the ocean yelling Help! Shark! Help!. I just laughed, I knew that shark wasn''t going to help them.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'alex@mail.com', 611.00, 'SGD', '2015-06-27', 'I do 5 sit-ups every morning. May not sound like much, but there is only so many times you can hit the snooze button...');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'john@mail.com', 761.00, 'AUD', '2015-08-02', 'I changed all my passwords to ''incorrect''. So my computer just tells me when I forgot.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'leo@mail.com', 587.00, 'CAD', '2015-10-24', 'I love how, in horror movies, the person yells out,Hello? As if the bad is going to yell back, Yeah, I''m in the kitchen! Do you want a sandwich? Or,Hey, yeah I''m back here with a chainsaw. Come on down.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'franz@mail.com', 666.00, 'GBP', '2015-04-03', 'Better late then never, but never late is better.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'vasya@mail.com', 792.00, 'AUD', '2015-01-21', 'I do 5 sit-ups every morning. May not sound like much, but there is only so many times you can hit the snooze button...');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'petya@mail.com', 521.00, 'MYR', '2015-02-23', 'On a scale of Voldemort to Pinocchio, how Nosy are you?');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'ivan@mail.com', 788.00, 'SGD', '2015-10-05', 'Whatever you do in life give 100%.....unless you''re giving blood.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'bobby@mail.com', 491.00, 'INR', '2015-02-04', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'lenny@mail.com', 247.00, 'EUR', '2015-10-10', 'I really like ceilings......I guess you could call me a ceiling fan.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'alex@mail.com', 137.00, 'CHF', '2015-06-04', 'I speak my mind. I never mind what I speak.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'john@mail.com', 514.00, 'GBP', '2015-12-16', 'I love how, in horror movies, the person yells out,Hello? As if the bad is going to yell back, Yeah, I''m in the kitchen! Do you want a sandwich? Or,Hey, yeah I''m back here with a chainsaw. Come on down.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'leo@mail.com', 990.00, 'INR', '2015-09-01', 'I dream of a better tomorrow, where chickens can cross the road and not be questioned about their motives.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'enzo@mail.com', 459.00, 'CHF', '2015-09-15', 'Anytime a bird poops on one of my windows, I eat a whole plate of scrambled egg on my patio. Just to show them what I''m capable of. Take that birds');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('vasya@mail.com', 'petya@mail.com', 120.00, 'INR', '2015-08-31', 'Anytime a bird poops on one of my windows, I eat a whole plate of scrambled egg on my patio. Just to show them what I''m capable of. Take that birds');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('petya@mail.com', 'ivan@mail.com', 610.00, 'GBP', '2015-01-13', 'I do 5 sit-ups every morning. May not sound like much, but there is only so many times you can hit the snooze button...');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('ivan@mail.com', 'bobby@mail.com', 466.00, 'CHF', '2015-05-16', 'One time at the beach this guy was swimming in the ocean yelling Help! Shark! Help!. I just laughed, I knew that shark wasn''t going to help them.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('bobby@mail.com', 'lenny@mail.com', 275.00, 'CHF', '2015-08-11', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('lenny@mail.com', 'alex@mail.com', 104.00, 'CHF', '2015-12-22', 'You remind me of my Chinese friend...Ug Lee.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('alex@mail.com', 'john@mail.com', 308.00, 'EUR', '2015-01-19', 'I was planning to do something today, but I haven''t finished doing nothing from yesterday.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('john@mail.com', 'leo@mail.com', 257.00, 'AUD', '2015-08-07', 'I changed all my passwords to ''incorrect''. So my computer just tells me when I forgot.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('leo@mail.com', 'enzo@mail.com', 477.00, 'MYR', '2015-10-20', 'One time at the beach this guy was swimming in the ocean yelling Help! Shark! Help!. I just laughed, I knew that shark wasn''t going to help them.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('enzo@mail.com', 'franz@mail.com', 436.00, 'USD', '2015-04-07', 'The dictionary is the only place where success comes before work.');
INSERT INTO billing (payer_email, recipient_email, sum, currency, billing_date, comment) VALUES ('franz@mail.com', 'vasya@mail.com', 398.00, 'GBP', '2015-07-30', 'I wish real life was like cartoons. I could wear the same outfit and nobody would care.');




select *
from billing
where payer_email = 'vasya@mail.com';

set search_path to lab1;

Insert into billing(payer_email,recipient_email,sum,currency,billing_date,comment)
  values ('otpravitel@mail.com','poluchatel@mail.com',300,'EUR','2016-02-14','Velintines day present)')

set search_path to lab1;


update billing
set payer_email = 'igor@gmail.ru'
where payer_email = 'alex@mail.com';


set search_path to lab1;


delete 
from billing
where payer_email = null;

set search_path to lab1;

select *
from(select distinct recipient_email
from billing
union
select distinct payer_email
from billing)
order by recipient_email;

set search_path to lab1;

select distinct currency
from billing;

set search_path to lab1;


with emails as (
    select distinct payer_email from billing
    union
    select distinct recipient_email from billing
),
currencies as (
    select distinct currency from billing
),
all_combinations as (
    select e.payer_email, c.currency
    from emails e
    cross join currencies c
)
select 
    dense_rank() over(order by ac.payer_email) as id,
    row_number() over(partition by ac.payer_email order by ac.currency) as c_id,
    ac.payer_email,
    ac.currency,
    COALESCE(SUM(b.sum), 0) as total_outcome,
    COALESCE(SUM(b2.sum),0) as total_income,
    COALESCE(SUM(b2.sum),0) - COALESCE(SUM(b.sum), 0) as balance
    
from all_combinations ac
left join billing b on ac.payer_email = b.payer_email and ac.currency = b.currency
left join billing b2 on ac.payer_email = b2.recipient_email and ac.currency = b2.currency
group by ac.payer_email, ac.currency
order by ac.payer_email, ac.currency;

set search_path to lab1;


with emails as (
    select distinct payer_email from billing
    union
    select distinct recipient_email from billing
),
currencies as (
    select distinct currency from billing
),
all_combinations as (
    select e.payer_email, c.currency
    from emails e
    cross join currencies c
),
new_table as (
  select 
    dense_rank() over(order by ac.payer_email) as id,
    row_number() over(partition by ac.payer_email order by ac.currency) as c_id,
    ac.payer_email,
    ac.currency,
    COALESCE(SUM(b.sum), 0) as total_outcome,
    COALESCE(SUM(b2.sum),0) as total_income,
    COALESCE(SUM(b2.sum),0) - COALESCE(SUM(b.sum), 0) as balance
    
from all_combinations ac
left join billing b on ac.payer_email = b.payer_email and ac.currency = b.currency
left join billing b2 on ac.payer_email = b2.recipient_email and ac.currency = b2.currency
group by ac.payer_email, ac.currency
order by ac.payer_email, ac.currency
)
  
select payer_email,currency,balance
from(
select *,row_number() over(partition by payer_email order by balance desc) as rank
from new_table)
where rank =1 or rank =10;

set search_path to lab1;

select currency, count(*) as transaction_count
from billing
group by currency
order by transaction_count desc
limit 1;


